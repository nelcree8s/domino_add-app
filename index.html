<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="theme-color" content="#5f7dff" />
    <link rel="manifest" href="manifest.json" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Domino" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <title>Domino Score</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/feather-icons"></script>
  </head>
  <body>
    <main class="main">
      <div class="score-shell">
        <div class="score-card">
          <div class="score-card__top">
            <button
              type="button"
              id="btnMenu"
              class="icon-btn"
              data-i18n-aria="ariaHistory"
              aria-label="History"
            >
              <i data-feather="clock"></i>
            </button>
            <span id="targetChip" class="chip chip--light">Target: 250</span>
            <div style="display: flex; gap: 0.5rem">
              <button
                type="button"
                id="btnRulesTop"
                class="icon-btn"
                data-i18n-aria="ariaRules"
                aria-label="Rules"
              >
                <i data-feather="help-circle"></i>
              </button>
              <button
                type="button"
                id="btnSettingsTop"
                class="icon-btn"
                data-i18n-aria="ariaSettings"
                aria-label="Settings"
              >
                <i data-feather="settings"></i>
              </button>
            </div>
          </div>
          <div class="score-card__math" id="scoreCardMath">
            Tap dots to add points
          </div>
          <div class="score-card__total-wrap" id="scoreCardTotalWrap">
            <div class="score-card__total" id="scoreCardTotal">0</div>
            <div class="score-card__unit">points</div>
          </div>
          <div class="score-card__divider"></div>
          <div class="match-score-display">
            <span class="match-score-team" id="matchScoreTeamA">
              <span class="match-score-name" id="matchScoreAName">Team A</span>: <span class="match-score-value" id="matchScoreAValue">0</span> / <span id="matchScoreTarget">250</span>
            </span>
            <span class="match-score-sep" aria-hidden="true"> · </span>
            <span class="match-score-team" id="matchScoreTeamB">
              <span class="match-score-name" id="matchScoreBName">Team B</span>: <span class="match-score-value" id="matchScoreBValue">0</span> / <span id="matchScoreTargetB">250</span>
            </span>
          </div>
        </div>

        <div class="team-tabs" role="tablist" aria-label="Who won">
          <button
            type="button"
            id="btnWinnerA"
            class="team-tab active"
            aria-selected="true"
          >
            <span class="team-tab__name" id="teamANameTab" data-i18n="teamA">Team A</span>
          </button>
          <button
            type="button"
            id="btnWinnerB"
            class="team-tab"
            aria-selected="false"
          >
            <span class="team-tab__name" id="teamBNameTab" data-i18n="teamB">Team B</span>
          </button>
        </div>

        <p id="instructionText" class="instruction-text" data-i18n="tapDotsThenApply">
          Tap dots to add points, then apply
        </p>
      </div>

      <section class="manual-section" id="manualSection">
        <div id="pipPicker" class="pip-picker"></div>

        <div class="bonus-row bonus-row--main">
          <label class="check"
            ><input type="checkbox" id="bonusOpeningPass" /><span data-i18n="bonusOpeningPass">Pase primera mano (opening pass)</span><button
              type="button"
              class="tooltip-trigger"
              data-tooltip="opening-pass"
              data-i18n-aria="ariaWhatIsThis"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusPaseCorrido" /><span data-i18n="bonusPaseCorrido">Pase corrido (skipping everyone)</span><button
              type="button"
              class="tooltip-trigger"
              data-tooltip="pase-corrido"
              data-i18n-aria="ariaWhatIsThis"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusCapicua" /><span data-i18n="bonusCapicua">Capicúa (matching ends)</span><button
              type="button"
              class="tooltip-trigger"
              data-tooltip="capicua"
              data-i18n-aria="ariaWhatIsThis"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusChuchazo" /><span data-i18n="bonusChuchazo">Chuchazo (double-blank)</span><button
              type="button"
              class="tooltip-trigger"
              data-tooltip="chuchazo"
              data-i18n-aria="ariaWhatIsThis"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
        </div>

        <div class="actions-row actions-row--main">
          <button type="button" id="btnClearBuckets" class="btn btn-secondary" data-i18n="clearHand">
            Clear hand
          </button>
          <button type="button" id="btnApplyScore" class="btn btn-primary" data-i18n="applyScore">
            Apply score
          </button>
        </div>
      </section>

      <!-- Game over overlay -->
      <div id="gameOverOverlay" class="game-over-overlay hidden">
        <div class="game-over-card">
          <h2 id="gameOverTitle" class="game-over-title">Team A wins!</h2>
          <p id="gameOverSubtitle" class="game-over-subtitle">First to 250</p>
          <button
            type="button"
            id="btnStartNew"
            class="btn btn-primary btn--large"
            data-i18n="startNewGame"
          >
            Start new game
          </button>
        </div>
      </div>

      <!-- Options overlay -->
      <div id="optionsOverlay" class="options-overlay hidden">
        <div class="options-panel">
          <div class="options-header">
            <h2 data-i18n="options">Options</h2>
            <button
              type="button"
              id="btnCloseOptions"
              class="close-btn"
              data-i18n-aria="ariaClose"
              aria-label="Close"
            >
              ×
            </button>
          </div>

          <div class="options-section">
            <h3 class="options-section-title" data-i18n="game">Game</h3>
            <label class="options-field">
              <span class="options-label" data-i18n="gameType">Game type</span>
              <select id="optGameType" class="select">
                <option value="200" data-i18n="gameType200">200</option>
                <option value="250" data-i18n="gameType250">250</option>
                <option value="500" data-i18n="gameType500">500</option>
                <option value="500-bonuses" data-i18n="gameType500Bonuses">500 with bonuses</option>
              </select>
            </label>
          </div>

          <div class="options-section">
            <h3 class="options-section-title" data-i18n="rules">Rules</h3>
            <label class="options-toggle">
              <span class="options-label" data-i18n="openingPassBonus">Opening pass bonus</span>
              <input type="checkbox" id="optOpeningPass" checked />
              <span class="toggle-switch"></span>
            </label>
            <label class="options-toggle">
              <span class="options-label" data-i18n="countAll500">In 500, count all hands on win</span>
              <input type="checkbox" id="optCountAll500" />
              <span class="toggle-switch"></span>
            </label>
          </div>

          <div class="options-section">
            <h3 class="options-section-title" data-i18n="bonusPoints">Bonus points</h3>
            <label class="options-field">
              <span class="options-label" data-i18n="paseCorridoPts">Pase corrido (pts)</span>
              <input
                type="number"
                id="optPaseCorridoPoints"
                class="select"
                min="0"
                value="25"
              />
            </label>
            <label class="options-field">
              <span class="options-label" data-i18n="capicuaPts">Capicúa (pts)</span>
              <input
                type="number"
                id="optCapicuaPoints"
                class="select"
                min="0"
                value="50"
              />
            </label>
            <label class="options-field">
              <span class="options-label" data-i18n="chuchazoPts">Chuchazo / double-blank (pts)</span>
              <input
                type="number"
                id="optChuchazoPoints"
                class="select"
                min="0"
                value="50"
              />
            </label>
          </div>

          <div class="options-actions">
            <button type="button" id="btnApplyOptions" class="btn btn-primary" data-i18n="apply">
              Apply
            </button>
          </div>
        </div>
      </div>

      <!-- Rules overlay -->
      <div id="rulesOverlay" class="options-overlay hidden">
        <div class="options-panel">
          <div class="options-header">
            <h2 data-i18n="rules">Rules</h2>
            <button
              type="button"
              id="btnCloseRules"
              class="close-btn"
              data-i18n-aria="ariaClose"
              aria-label="Close"
            >
              ×
            </button>
          </div>

          <div class="rules-content">
            <h3 data-i18n="rulesHowYouScore">How you score points</h3>
            <div class="rule-item">
              <h4 data-i18n="rulesWinningHand">1. Winning the hand (leftover pieces)</h4>
              <p data-i18n="rulesWinningHandP">When a player gets rid of all their pieces, their team wins. Add up the dots on all pieces not played. That total goes to the winning team's score.</p>
            </div>
            <div class="rule-item">
              <h4 data-i18n="rulesPasePrimera">2. Pase primera mano (opening pass)</h4>
              <p data-i18n="rulesPasePrimeraP">Only on the very first play of the hand. If the next player cannot play, the first player's team gets 10 (200/250) or 25 (500). Nullified if the next player after that also cannot play.</p>
            </div>
            <div class="rule-item">
              <h4 data-i18n="rulesPaseCorrido">3. Pase corrido (skipping everyone)</h4>
              <p data-i18n="rulesPaseCorridoP">A player plays and all three opponents cannot play. That player's team gets 25 pts (default; configurable). That player then plays again.</p>
            </div>
            <div class="rule-item">
              <h4 data-i18n="rulesCapicua">4. Capicúa (matching ends)</h4>
              <p data-i18n="rulesCapicuaP">The last piece matches the number at the opposite end of the chain. Worth 50 pts (default; configurable). Nullified if matched with a blank or double.</p>
            </div>
            <div class="rule-item">
              <h4 data-i18n="rulesChuchazo">5. Chuchazo (double-blank)</h4>
              <p data-i18n="rulesChuchazoP">The winning piece is the double-blank (0–0), "la Chucha!" Worth 50 pts (default; configurable).</p>
            </div>
            <div class="rule-item">
              <h4 data-i18n="rulesTranque">6. Tranque (lock)</h4>
              <p data-i18n="rulesTranqueP">No one can play. Compare hands; lowest total wins and gets opponents' leftover points. Tie goes to the player who started the hand.</p>
            </div>

            <h3 style="margin-top: 2rem" data-i18n="rulesGameTypes">Game types</h3>
            <div class="rule-item">
              <p data-i18n="rulesGameTypesP1">200, 250, 500: First to reach target score.</p>
              <p data-i18n="rulesGameTypesP2">500 with bonuses: Same as 500, plus round bonuses: 1st hand +100, 2nd +75, 3rd +50, 4th +25.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- History drawer -->
      <div id="listView" class="list-view hidden">
        <div class="list-header">
          <h2 data-i18n="recentHands">Recent hands</h2>
          <button type="button" id="btnCloseList" class="close-btn" data-i18n-aria="ariaClose" aria-label="Close">×</button>
        </div>

        <div class="panel history-panel">
          <div class="history-header">
            <h3 data-i18n="history">History</h3>
            <button type="button" id="btnNewGame" class="btn btn-secondary" data-i18n="newGame">
              New game
            </button>
          </div>
          <ul id="historyList" class="history-list"></ul>
        </div>
      </div>
    </main>

    <script src="app.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("sw.js").catch(function () {});
      }
    </script>
  </body>
</html>
