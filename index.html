<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="theme-color" content="#fafafa" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <title>Domino Score</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/feather-icons"></script>
  </head>
  <body>
    <main class="main">
      <div class="score-shell">
        <div class="score-card">
          <div class="score-card__top">
            <button
              type="button"
              id="btnMenu"
              class="icon-btn"
              aria-label="History"
            >
              <i data-feather="clock"></i>
            </button>
            <span id="targetChip" class="chip chip--light">Target: 250</span>
            <div style="display: flex; gap: 0.5rem">
              <button
                type="button"
                id="btnRulesTop"
                class="icon-btn"
                aria-label="Rules"
              >
                <i data-feather="help-circle"></i>
              </button>
              <button
                type="button"
                id="btnSettingsTop"
                class="icon-btn"
                aria-label="Settings"
              >
                <i data-feather="settings"></i>
              </button>
            </div>
          </div>
          <div class="score-card__math" id="scoreCardMath">
            Tap dots to add points
          </div>
          <div class="score-card__total-wrap" id="scoreCardTotalWrap">
            <div class="score-card__total" id="scoreCardTotal">0</div>
            <div class="score-card__unit">points</div>
          </div>
        </div>

        <div class="team-tabs" role="tablist" aria-label="Who won">
          <button
            type="button"
            id="btnWinnerA"
            class="team-tab active"
            aria-selected="true"
          >
            <span class="team-tab__name" id="teamANameTab">Team A</span>
            <span class="team-tab__score" id="teamATabScore">0</span>
          </button>
          <button
            type="button"
            id="btnWinnerB"
            class="team-tab"
            aria-selected="false"
          >
            <span class="team-tab__name" id="teamBNameTab">Team B</span>
            <span class="team-tab__score" id="teamBTabScore">0</span>
          </button>
        </div>

        <p id="instructionText" class="instruction-text">
          Tap dots to add points, then apply
        </p>
      </div>

      <section class="manual-section" id="manualSection">
        <div id="pipPicker" class="pip-picker"></div>

        <div class="bonus-row bonus-row--main">
          <label class="check"
            ><input type="checkbox" id="bonusOpeningPass" /> Pase primera mano
            (opening pass)<button
              type="button"
              class="tooltip-trigger"
              data-tooltip="opening-pass"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusPaseCorrido" /> Pase corrido
            (skipping everyone)<button
              type="button"
              class="tooltip-trigger"
              data-tooltip="pase-corrido"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusCapicua" /> Capicúa (matching
            ends)<button
              type="button"
              class="tooltip-trigger"
              data-tooltip="capicua"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
          <label class="check"
            ><input type="checkbox" id="bonusChuchazo" /> Chuchazo
            (double-blank)<button
              type="button"
              class="tooltip-trigger"
              data-tooltip="chuchazo"
              aria-label="What is this?"
            >
              ?
            </button></label
          >
        </div>

        <div class="actions-row actions-row--main">
          <button type="button" id="btnClearBuckets" class="btn btn-secondary">
            Clear hand
          </button>
          <button type="button" id="btnApplyScore" class="btn btn-primary">
            Apply score
          </button>
        </div>
      </section>

      <!-- Game over overlay -->
      <div id="gameOverOverlay" class="game-over-overlay hidden">
        <div class="game-over-card">
          <h2 id="gameOverTitle" class="game-over-title">Team A wins!</h2>
          <p id="gameOverSubtitle" class="game-over-subtitle">First to 250</p>
          <button
            type="button"
            id="btnStartNew"
            class="btn btn-primary btn--large"
          >
            Start new game
          </button>
        </div>
      </div>

      <!-- Options overlay -->
      <div id="optionsOverlay" class="options-overlay hidden">
        <div class="options-panel">
          <div class="options-header">
            <h2>Options</h2>
            <button
              type="button"
              id="btnCloseOptions"
              class="close-btn"
              aria-label="Close"
            >
              ×
            </button>
          </div>

          <div class="options-section">
            <h3 class="options-section-title">Game</h3>
            <label class="options-field">
              <span class="options-label">Game type</span>
              <select id="optGameType" class="select">
                <option value="200">200</option>
                <option value="250">250</option>
                <option value="500">500</option>
                <option value="500-bonuses">500 with bonuses</option>
              </select>
            </label>
          </div>

          <div class="options-section">
            <h3 class="options-section-title">Rules</h3>
            <label class="options-toggle">
              <span class="options-label">Opening pass bonus</span>
              <input type="checkbox" id="optOpeningPass" checked />
              <span class="toggle-switch"></span>
            </label>
            <label class="options-toggle">
              <span class="options-label">In 500, count all hands on win</span>
              <input type="checkbox" id="optCountAll500" />
              <span class="toggle-switch"></span>
            </label>
          </div>

          <div class="options-section">
            <h3 class="options-section-title">Bonus points</h3>
            <label class="options-field">
              <span class="options-label">Pase corrido (pts)</span>
              <input
                type="number"
                id="optPaseCorridoPoints"
                class="select"
                min="0"
                value="25"
              />
            </label>
            <label class="options-field">
              <span class="options-label">Capicúa (pts)</span>
              <input
                type="number"
                id="optCapicuaPoints"
                class="select"
                min="0"
                value="50"
              />
            </label>
            <label class="options-field">
              <span class="options-label">Chuchazo / double-blank (pts)</span>
              <input
                type="number"
                id="optChuchazoPoints"
                class="select"
                min="0"
                value="50"
              />
            </label>
          </div>

          <div class="options-actions">
            <button type="button" id="btnApplyOptions" class="btn btn-primary">
              Apply
            </button>
          </div>
        </div>
      </div>

      <!-- Rules overlay -->
      <div id="rulesOverlay" class="options-overlay hidden">
        <div class="options-panel">
          <div class="options-header">
            <h2>Rules</h2>
            <button
              type="button"
              id="btnCloseRules"
              class="close-btn"
              aria-label="Close"
            >
              ×
            </button>
          </div>

          <div class="rules-content">
            <h3>How you score points</h3>
            <div class="rule-item">
              <h4>1. Winning the hand (leftover pieces)</h4>
              <p>
                When a player gets rid of all their pieces, their team wins. Add
                up the dots on all pieces not played. That total goes to the
                winning team's score.
              </p>
            </div>
            <div class="rule-item">
              <h4>2. Pase primera mano (opening pass)</h4>
              <p>
                Only on the very first play of the hand. If the next player
                cannot play, the first player's team gets
                <strong>10</strong> (200/250) or <strong>25</strong> (500).
                Nullified if the next player after that also cannot play.
              </p>
            </div>
            <div class="rule-item">
              <h4>3. Pase corrido (skipping everyone)</h4>
              <p>
                A player plays and all three opponents cannot play. That
                player's team gets <strong>25</strong> pts (default;
                configurable). That player then plays again.
              </p>
            </div>
            <div class="rule-item">
              <h4>4. Capicúa (matching ends)</h4>
              <p>
                The last piece matches the number at the opposite end of the
                chain. Worth <strong>50</strong> pts (default; configurable).
                Nullified if matched with a blank or double.
              </p>
            </div>
            <div class="rule-item">
              <h4>5. Chuchazo (double-blank)</h4>
              <p>
                The winning piece is the double-blank (0–0), "la Chucha!" Worth
                <strong>50</strong> pts (default; configurable).
              </p>
            </div>
            <div class="rule-item">
              <h4>6. Tranque (lock)</h4>
              <p>
                No one can play. Compare hands; lowest total wins and gets
                opponents' leftover points. Tie goes to the player who started
                the hand.
              </p>
            </div>

            <h3 style="margin-top: 2rem">Game types</h3>
            <div class="rule-item">
              <p>
                <strong>200, 250, 500:</strong> First to reach target score.
              </p>
              <p>
                <strong>500 with bonuses:</strong> Same as 500, plus round
                bonuses: 1st hand +100, 2nd +75, 3rd +50, 4th +25.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- History drawer -->
      <div id="listView" class="list-view hidden">
        <div class="list-header">
          <h2>Recent hands</h2>
          <button type="button" id="btnCloseList" class="close-btn">×</button>
        </div>

        <div class="panel history-panel">
          <div class="history-header">
            <h3>History</h3>
            <button type="button" id="btnNewGame" class="btn btn-secondary">
              New game
            </button>
          </div>
          <ul id="historyList" class="history-list"></ul>
        </div>
      </div>
    </main>

    <script src="app.js"></script>
  </body>
</html>
